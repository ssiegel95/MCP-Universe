{
    "category": "security",
    "question": "Implement Row Level Security (RLS) policies for a social media platform with Users, Posts, Comments, and Channels.\n\n## Your Mission:\n\nBuild RLS policies for a social platform where users create posts and comments in channels. Implement proper access control so users can manage their own content, while channel moderators can moderate content in their channels.\n\n## RLS Requirements:\n\n### 1. Users Table Access Rules:\n- **SELECT**: Users can read all public user profiles (username, created_at)\n- **UPDATE**: Users can only modify their own profile\n- **DELETE**: Users can only delete their own account\n\n### 2. Channels Table Access Rules:\n- **SELECT**: Everyone can read public channel information\n- **INSERT**: Any authenticated user can create a channel (becomes owner)\n- **UPDATE**: Only channel owners can modify channel details\n- **DELETE**: Only channel owners can delete channels\n\n### 3. Posts Table Access Rules:\n- **SELECT**: Users can read all posts in channels they have access to\n- **INSERT**: Authenticated users can create posts in any channel\n- **UPDATE**: Post authors OR channel moderators OR channel owners can edit posts\n- **DELETE**: Post authors OR channel moderators OR channel owners can delete posts\n\n### 4. Comments Table Access Rules:\n- **SELECT**: Users can read comments on posts they can access\n- **INSERT**: Authenticated users can comment on posts they can see\n- **UPDATE**: Comment authors OR post authors OR channel moderators OR channel owners can edit comments\n- **DELETE**: Comment authors OR post authors OR channel moderators OR channel owners can delete comments",
    "use_specified_server": true,
    "mcp_servers": [
        {
            "name": "postgres-pro"
        }
    ],
    "output_format": {
        "rls_status": "RLS implementation completion report"
    },
    "prepares": [
        {
            "prepare_func": "mcpmark_postgres_setup",
            "prepare_args": {}
        }
    ],
    "evaluators": [
        {
            "func": "raw",
            "op": "postgres_rls_business_access_verifier",
            "value": "completed",
            "op_args": {},
            "desc": "Check if the AI agent implemented RLS policies correctly for the social media platform"
        }
    ],
    "cleanups": [
        {
            "server": "mcpmark",
            "tool": "",
            "cleanup_func": "postgres_cleanup",
            "cleanup_args": {}
        }
    ]
}