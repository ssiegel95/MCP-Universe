{
    "category": "lego",
    "question": "Create a PostgreSQL function to handle inventory part transfers between LEGO sets with enhanced validation and audit capabilities. The LEGO warehouse management system needs to support transferring parts while maintaining data integrity and tracking transfer history.\n\n## Your Tasks:\n\n1. **Create the transfer function** — Implement a PostgreSQL function named `transfer_parts` with the following signature:\n   ```sql\n   CREATE OR REPLACE FUNCTION transfer_parts(\n       source_inventory_id INTEGER,\n       target_inventory_id INTEGER,\n       part_to_transfer_num VARCHAR,\n       color_to_transfer_id INTEGER,\n       quantity_to_transfer INTEGER,\n       transfer_reason VARCHAR DEFAULT 'manual_transfer'\n   ) RETURNS TEXT\n   ```\n\n2. **Create audit logging table** — Create a new table to track transfer history:\n   ```sql\n   CREATE TABLE inventory_transfer_log (\n       log_id SERIAL PRIMARY KEY,\n       transfer_timestamp TIMESTAMP DEFAULT NOW(),\n       source_inventory_id INTEGER NOT NULL,\n       target_inventory_id INTEGER NOT NULL,\n       part_num VARCHAR NOT NULL,\n       color_id INTEGER NOT NULL,\n       quantity_transferred INTEGER NOT NULL,\n       transfer_reason VARCHAR,\n       operation_status VARCHAR(20) NOT NULL\n   );\n   ```",
    "use_specified_server": true,
    "mcp_servers": [
        {
            "name": "postgres-pro"
        }
    ],
    "output_format": {
        "transfer_status": "Transactional inventory transfer function completion status"
    },
    "evaluators": [
        {
            "func": "raw",
            "op": "postgres_transactional_inventory_transfer_verifier",
            "value": "completed",
            "op_args": {},
            "desc": "Check if the AI agent implemented the transactional inventory transfer function with audit logging"
        }
    ],
    "prepares": [
        {
            "prepare_func": "mcpmark_postgres_setup",
            "prepare_args": {}
        }
    ],
    "cleanups": [
        {
            "server": "mcpmark",
            "tool": "",
            "cleanup_func": "postgres_cleanup",
            "cleanup_args": {}
        }
    ]
}