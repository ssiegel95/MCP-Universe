{
    "category": "sports",
    "question": "# Query Performance Optimization\n\n## Background\nYou need to optimize a slow-running analytics query that generates performance reports. The query currently takes too long to execute and needs optimization.\n\n## Requirements\n\n### 1. Create Performance Report Table\nCreate a table called `participant_performance_report` with the following structure:\n- report_id (serial primary key)\n- participant_id (integer not null)\n- event_count (integer)\n- stat_count (integer)\n- stat_type_count (integer)\n- last_event_date (timestamp)\n- created_at (timestamp default current_timestamp)\n\nAdd constraint: CHECK (participant_id > 0)\n\n### 2. Execute and Optimize the Slow Query\nThe following query is currently running very slowly. Your task is to:\n1. **Identify why the query is slow**\n2. **Create appropriate indexes to optimize it** \n3. **Populate the report table with the query results**",
    "use_specified_server": true,
    "mcp_servers": [
        {
            "name": "postgres-pro"
        }
    ],
    "output_format": {
        "optimization_status": "Query optimization completion status"
    },
    "evaluators": [
        {
            "func": "raw",
            "op": "postgres_participant_report_optimization_verifier",
            "value": "completed",
            "op_args": {},
            "desc": "Check if the AI agent optimized the slow query and created the performance report table"
        }
    ],
    "prepares": [
        {
            "prepare_func": "mcpmark_postgres_setup",
            "prepare_args": {}
        }
    ],
    "cleanups": [
        {
            "server": "mcpmark",
            "tool": "",
            "cleanup_func": "postgres_cleanup",
            "cleanup_args": {}
        }
    ]
}