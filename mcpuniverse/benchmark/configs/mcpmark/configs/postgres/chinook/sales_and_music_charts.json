{
    "category": "chinook",
    "question": "Create a monthly sales dashboard and top music charts system for Chinook's management team to track business performance and identify trending music content.\n\n## Your Tasks:\n\n1. **Build the monthly sales summary table** — create a table called `monthly_sales_summary` in the `public` schema with:\n   * `year_month` (varchar) — format as 'YYYY-MM' (e.g., '2009-01')\n   * `total_invoices` (integer) — number of invoices in that month\n   * `total_revenue` (decimal) — sum of all invoice totals for the month\n   * `total_tracks_sold` (integer) — total quantity of individual tracks sold\n   * `average_invoice_value` (decimal) — average invoice amount for the month\n   * `unique_customers` (integer) — count of distinct customers who made purchases\n\n2. **Create the music charts table** — build a table called `top_music_charts` in the `public` schema with:\n   * `chart_type` (varchar) — either 'top_tracks', 'top_albums', or 'top_artists'\n   * `rank_position` (integer) — ranking from 1 to 10\n   * `item_id` (integer) — ID of the track, album, or artist\n   * `item_name` (varchar) — name of the track, album, or artist\n   * `total_revenue` (decimal) — total revenue generated by this item\n\n3. **Populate the monthly sales data**:\n   * Calculate metrics for each month that has invoice data\n   * Use invoice date to determine the month\n   * **Note**: Each invoice can contain multiple invoice lines (tracks)\n\n4. **Generate the top 10 charts**:\n   * **Top Tracks**: Rank tracks by total quantity sold across all invoices\n   * **Top Albums**: Rank albums by total revenue generated from their tracks\n   * **Top Artists**: Rank artists by total revenue from all their tracks across all albums\n\n5. **Business rules to follow**:\n   * Only include months where at least one invoice exists\n   * For album rankings, sum revenue from all tracks in each album\n   * For artist rankings, sum revenue from all tracks across all their albums\n   * Handle ties by using item name alphabetically as tiebreaker\n   * Exclude any items with zero sales\n\nThis system will provide clear, actionable business intelligence for monthly reporting and music trend analysis.",
    "use_specified_server": true,
    "mcp_servers": [
        {
            "name": "postgres-pro"
        }
    ],
    "output_format": {
        "dashboard_status": "Sales dashboard and music charts creation report"
    },
    "evaluators": [
        {
            "func": "raw",
            "op": "postgres_sales_music_charts_verifier",
            "value": "completed",
            "op_args": {},
            "desc": "Check if the AI agent created the monthly sales dashboard and music charts system"
        }
    ],
    "prepares": [
        {
            "prepare_func": "mcpmark_postgres_setup",
            "prepare_args": {}
        }
    ],
    "cleanups": [
        {
            "server": "mcpmark",
            "tool": "",
            "cleanup_func": "postgres_cleanup",
            "cleanup_args": {}
        }
    ]
}